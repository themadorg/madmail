<!DOCTYPE html>
<html dir="rtl" lang="fa">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <title>ุณุฑูุฑ ฺุช {{.MailDomain | cleanDomain}}</title>
    <link rel="stylesheet" href="./main.css">
    <script src="./main.js"></script>
    <link rel="icon" href="/logo.svg">
    <style>
        body {
            font-family: Tahoma, Arial, sans-serif;
            text-align: center;
        }

        .cta-button {
            margin: 20px 0;
            cursor: pointer;
            border: none;
        }

        #account-result {
            display: none;
            margin: 20px auto;
            padding: 20px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            max-width: 500px;
        }

        .manual-box {
            text-align: right;
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin-top: 30px;
            font-size: 0.9em;
            line-height: 1.8;
        }

        .copy-text {
            font-family: monospace;
            background: #000;
            padding: 5px;
            border-radius: 4px;
            color: #00d2ff;
            cursor: pointer;
            word-break: break-all;
            display: block;
            margin-top: 10px;
            direction: ltr;
        }

        #menu {
            justify-content: center;
        }

        #menu li {
            margin: 0 10px;
        }

        #domain {
            display: none;
        }
    </style>
</head>

<body>

    <ul id="menu">
        <li><a href="/">ุงุตู</a></li>
        <li><a href="/share">ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ</a></li>
        <li><a href="/info.html">ุฑุงูููุง</a></li>
        <li><a href="/security.html">ุงููุช</a></li>
        <li><a href="/deploy.html">ุฑุงูโุงูุฏุงุฒ</a></li>
    </ul>

    <h2>ุณุฑูุฑ ฺุช {{.MailDomain | cleanDomain}}</h2>
    <p>ุงู ฺฉ ุณุฑูุฑ ุงุฎุชุตุงุต ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ <strong>ุฏูุชุงฺุช</strong> ุงุณุช.</p>

    <button class="cta-button" style="font-size: 0.9em; padding: 10px 20px;" onclick="generateAccount()">ูุฌุฏุฏ</button>

    <div id="account-result">
        <div style="display: flex; gap: 10px; margin: 20px 0; justify-content: center; flex-wrap: wrap;">
            <button class="cta-button" onclick="openDeltaChat()" style="font-size: 0.9em; padding: 10px 20px;">ุณุงุฎุช
                ุงฺฉุงูุช ู ูุฑูุฏ</button>
            <button class="cta-button" onclick="copyLink()"
                style="font-size: 0.9em; padding: 10px 20px; background: #444;">ฺฉูพ ููฺฉ</button>
        </div>

        <div style="background: white; padding: 10px; border-radius: 8px; display: inline-block;">
            <img id="result-qr" width="180" alt="QR Code" />
        </div>
    </div>

    <div class="manual-box">
        <strong>ุฑุงูููุง ุงูุฒูุฏู ุฏุณุช (ุงฺฏุฑ ุฏฺฉูู ฺฉุงุฑ ูฺฉุฑุฏ):</strong>
        <ol>
            <li>ุฏุฑ ุฏูุชุงฺุช "ุงุฌุงุฏ ูพุฑููุงู ุฌุฏุฏ" (Create new profile) ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ.</li>
            <li>ุณูพุณ "ุงุณุชูุงุฏู ุงุฒ ุณุฑูุฑ ุฏฺฏุฑ" (Use Other server) ุฑุง ุจุฒูุฏ.</li>
            <li>ุนุจุงุฑุช ุฒุฑ ุฑุง ฺฉูพ ฺฉุฑุฏู ู ุฏุฑ ุจุฎุด ุงุณฺฉู ฺฉุฏุ ฺฏุฒูู "ุฌุงฺฏุฐุงุฑ ุงุฒ ุญุงูุธู" (Paste from clipboard) ุฑุง ุจุฒูุฏ:</li>
        </ol>
        <p id="manual-link" dir="ltr" style="word-break: break-all; margin-top: 10px; color: #ccc; cursor: pointer;"
            onclick="copyText(this)"></p>
    </div>

    <div class="manual-box" style="background: rgba(255, 255, 255, 0.05); border-top: 1px solid #444;">
        <strong>ูฺฉุชู ูุฎุตูุต ฺฉุงุฑุจุฑุงู iOS (ุขููู):</strong>
        <p style="font-size: 0.9em; margin-top: 10px;">ฺฉุงุฑุจุฑุงู ุขููู ุจุงุฏ ููฺฉ ุงุณุชุงูุฏุงุฑุฏ ุจุงูุง ุฑุง ฺฉูพ ฺฉุฑุฏู ู ุฏุฑ ููฺฏุงู
            ุณุงุฎุช ุงฺฉุงูุช ุฌุฏุฏ ุจู ุดฺฉู ุฒุฑ ุนูู ฺฉููุฏ:</p>
        <p dir="ltr" style="font-size: 0.85em;">new account > use other server > scan > paste</p>
        <p style="font-size: 0.85em; margin-top: 10px;">ุงฺฏุฑฺู ฺฉูฺฉ ุฑู ุฏฺฉูู ูุฑูุฏ ุฏุฑ iOS ููฺฉู ุงุณุช ฺฉุงุฑ ฺฉูุฏุ ุงูุง ุจู ุฏูู
            ูุญุฏูุฏุชโูุง ุณุณุชูโุนุงููุ ุฑูุด ฺฉูพ ู ุฌุงฺฏุฐุงุฑ (Paste) ูพุดููุงุฏ ูโุดูุฏ.</p>
    </div>

    {{if .SSURL}}
    <div class="ss-prominent-box">
        <strong>๐ ูุทูุง ุจุฑุง ุณุฑุนุช ุจุดุชุฑ ูพุงู ุฑุณุงู ุฏุงุฎู ุฎูุฏ ุงูพูฺฉุดู ุฏูุชุงฺุช ุงุฒ ุงู ูพุฑูฺฉุณ ุงุณุชูุงุฏู ฺฉูู.</strong>
        <p>ุชูุฌู ุฏุงุดุชู ุจุงุดู ฺฉู ุงู ูพุฑูฺฉุณ ููุท ุฏุฑ ุฏุงุฎู ููู ุณุฑูุฑ ู ููุท ุจุฑุง ูพุงู ุฑุณุงู ุจู ููู ุณุฑูุฑ ูุงุจู ุงุณุชูุงุฏู ุงุณุช! ูุฑ
            ุณุฑูุฑ ุฏฺฏุฑ madmail ูพุฑูฺฉุณ ุฎูุฏุด ุฑุง ุฎูุงูุฏ ุฏุงุดุช</p>

        <div class="ss-copy-container">
            <p>ููฺฉ ูพุฑูฺฉุณ Shadowsocks:</p>
            <div class="ss-copy-text" onclick="copyToClipboard('{{.SSURL}}')">{{.SSURL}}</div>
        </div>

        <p style="font-size: 0.85em; color: #bbb;">ูุญูู ุงุณุชูุงุฏู: ุชูุธูุงุช > ูพุดุฑูุชู > ุดุจฺฉู > ูพุฑูฺฉุณ SOCKS5</p>

        <p
            style="font-size: 0.75em; color: #888; margin-top: 15px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 10px;">
            * ุงู ูพุฑูฺฉุณ ูุฎุชุต ููู ุณุฑูุฑ Madmail ุงุณุช.
        </p>
    </div>
    {{end}}

    <div
        style="margin-top: 40px; padding: 20px; background: var(--card-bg); border-radius: 12px; border: 1px solid rgba(255,255,255,0.1);">
        <h3>ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ ุขโุฏ</h3>
        <p style="margin-bottom: 20px;">ุดูุง ูโุชูุงูุฏ ุขโุฏ ุฏูุชุงฺุช ุฎูุฏ ุฑุง ุจู ุงุดุชุฑุงฺฉ ุจฺฏุฐุงุฑุฏ ุชุง ุฏฺฏุฑุงู ุจุชูุงููุฏ ุจุง ุดูุง
            ุชูุงุณ ุจฺฏุฑูุฏ.</p>
        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
            <a href="/share" class="cta-button">ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ ุขโุฏ ูู</a>
        </div>
    </div>

    <script>
        let currentLink = "";

        function generateRandomString(length) {
            const charset = "abcdefghijklmnopqrstuvwxyz0123456789";
            let result = "";
            for (let i = 0; i < length; i++) {
                result += charset.charAt(Math.floor(Math.random() * charset.length));
            }
            return result;
        }

        function generateAccount() {
            const username = generateRandomString(12);
            const password = generateRandomString(24);
            const email = `${username}@{{.MailDomain | cleanDomain}}`;
            const host = "{{.PublicIP | cleanDomain}}" || "{{.MXDomain | cleanDomain}}";
            const turnOffTLS = ("{{if .TurnOffTLS}}true{{else}}false{{end}}" === "true");

            if (turnOffTLS) {
                currentLink = `dclogin:${email}/?p=${encodeURIComponent(password)}&v=1&ih=${host}&ip=143&sh=${host}&sp=25&is=plain&ss=plain&sc=3`;
            } else {
                currentLink = `dclogin:${email}/?p=${encodeURIComponent(password)}&v=1&ih=${host}&ip=993&sh=${host}&sp=465&ic=3&ss=default`;
            }


            document.getElementById('manual-link').innerText = currentLink;
            document.getElementById('result-qr').src = `/qr?data=${encodeURIComponent(currentLink)}`;
            document.getElementById('account-result').style.display = 'block';
        }

        function openDeltaChat() {
            if (currentLink) window.location.href = currentLink;
        }



        function copyLink() {
            if (currentLink) {
                copyToClipboard(currentLink);
            }
        }

        function copyText(el) {
            copyToClipboard(el.innerText);
        }

        window.onload = generateAccount;
    </script>

    <footer
        style="margin-top: 50px; padding: 20px; font-size: 0.8em; color: #888; border-top: 1px solid rgba(255,255,255,0.1);">
        ูุณุฎู {{.Version}}
    </footer>
</body>

</html>